@import "tailwindcss";
@config "../tailwind.config.js";

/* Screen reader only class for accessibility */
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border-width: 0;
}

/* Enhanced focus indicators for keyboard navigation */
*:focus-visible {
  outline: 2px solid var(--scripture-accent);
  outline-offset: 2px;
  border-radius: 4px;
}

/* Ensure buttons have visible focus */
button:focus-visible,
a:focus-visible,
input:focus-visible,
textarea:focus-visible,
select:focus-visible {
  outline: 2px solid var(--scripture-accent);
  outline-offset: 2px;
}

@layer base {
  /* iOS-inspired Light theme colors - Clean, crisp, high contrast */
  :root {
    --scripture-bg: #ffffff;
    --scripture-surface: #ffffff;
    --scripture-elevated: #f2f2f7;
    --scripture-border: 198 198 200; /* #c6c6c8 in RGB format for opacity support */
    --scripture-separator: 198 198 200;
    --scripture-overlay-border: 198 198 200;
    --scripture-text: #000000;
    --scripture-muted: #8e8e93;
    --scripture-accent: #007aff;
    --scripture-accent-muted: #0051d5;
    /* Theme-aware semantic colors - iOS style */
    --scripture-error: #ff3b30;
    --scripture-error-bg: #ffe5e3;
    --scripture-error-text: #d70015;
    --scripture-warning: #ff9500;
    --scripture-warning-bg: #fff4e5;
    --scripture-warning-text: #d68910;
    --scripture-success: #34c759;
    --scripture-success-bg: #e5f9ed;
    --scripture-success-text: #248a3d;
    --scripture-info: #007aff;
    --scripture-info-bg: #e5f2ff;
    --scripture-info-text: #0051d5;
    /* Backdrop/overlay opacity */
    --scripture-backdrop-opacity: 0.4;
  }

  /* iOS-inspired Dark theme colors - True black with high contrast */
  html.dark {
    --scripture-bg: #000000;
    --scripture-surface: #1c1c1e;
    --scripture-elevated: #2c2c2e;
    --scripture-border: 100 100 100; /* #646464 in RGB format for opacity support - lighter grey for better visibility */
    --scripture-separator: 100 100 100;
    --scripture-overlay-border: 100 100 100;
    --scripture-text: #ffffff;
    --scripture-muted: #98989d;
    --scripture-accent: #0a84ff;
    --scripture-accent-muted: #409cff;
    /* Theme-aware semantic colors - iOS dark mode */
    --scripture-error: #ff453a;
    --scripture-error-bg: #3d1f1f;
    --scripture-error-text: #ff6961;
    --scripture-warning: #ff9f0a;
    --scripture-warning-bg: #3d2f1f;
    --scripture-warning-text: #ffb340;
    --scripture-success: #30d158;
    --scripture-success-bg: #1f3d2f;
    --scripture-success-text: #66d98f;
    --scripture-info: #0a84ff;
    --scripture-info-bg: #1f2f3d;
    --scripture-info-text: #64b5ff;
    /* Backdrop/overlay opacity - darker theme needs more opacity */
    --scripture-backdrop-opacity: 0.6;
  }

  * {
    -webkit-tap-highlight-color: transparent;
  }
  
  html {
    @apply antialiased;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  body {
    background-color: var(--scripture-bg);
    color: var(--scripture-text);
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', 'Segoe UI', system-ui, sans-serif;
    /* Safe area insets are now applied selectively to individual components
       (NavigationBar, Toolbar, Modals) rather than globally on body.
       This prevents double-padding and allows fixed elements to position correctly. */
  }

  /* Reset default button borders to use CSS variables */
  button {
    border-color: rgb(var(--scripture-border));
  }
  
  button[type="button"],
  button[type="submit"],
  button:not([type]) {
    border-color: rgb(var(--scripture-border));
  }

  /* Scripture text styling */
  .scripture-text {
    @apply font-scripture leading-relaxed;
    letter-spacing: 0.01em;
    color: var(--scripture-text);
  }

  /* Verse content styling - ensure text color is set explicitly */
  .verse-content {
    color: var(--scripture-text);
  }

  /* Verse wrapper - ensure text color inheritance */
  .verse {
    color: var(--scripture-text);
  }

  /* Verse number styling - iOS blue accent */
  .verse-number {
    @apply text-scripture-accent font-ui text-sm mr-1.5 select-none;
    vertical-align: baseline;
    display: inline-block;
    font-size: 0.875em;
    line-height: inherit;
    font-weight: 600;
    opacity: 1;
  }

  /* Cross-reference styling - iOS blue accent */
  .cross-ref {
    @apply text-scripture-accent cursor-pointer hover:text-scripture-accent transition-colors;
    font-size: 0.85em;
    font-weight: 600;
    vertical-align: super;
    margin: 0 0.15em;
    opacity: 0.8;
  }

  .cross-ref:hover {
    opacity: 1;
    text-decoration: underline;
  }

  /* Selection styling - iOS blue */
  ::selection {
    background-color: rgba(0, 122, 255, 0.3);
    color: var(--scripture-text);
  }

  /* Light theme selection */
  .light ::selection {
    background-color: rgba(0, 122, 255, 0.25);
    color: var(--scripture-text);
  }

  /* Dark theme selection */
  .dark ::selection {
    background-color: rgba(10, 132, 255, 0.4);
    color: var(--scripture-text);
  }
}

@layer components {
  /* Highlight classes for annotations */
  .highlight-red { @apply bg-highlight-red/30; }
  .highlight-orange { @apply bg-highlight-orange/30; }
  .highlight-amber { @apply bg-highlight-amber/30; }
  .highlight-yellow { @apply bg-highlight-yellow/30; }
  .highlight-lime { @apply bg-highlight-lime/30; }
  .highlight-green { @apply bg-highlight-green/30; }
  .highlight-teal { @apply bg-highlight-teal/30; }
  .highlight-cyan { @apply bg-highlight-cyan/30; }
  .highlight-blue { @apply bg-highlight-blue/30; }
  .highlight-indigo { @apply bg-highlight-indigo/30; }
  .highlight-purple { @apply bg-highlight-purple/30; }
  .highlight-pink { @apply bg-highlight-pink/30; }

  /* Text color classes */
  .text-color-red { @apply text-highlight-red; }
  .text-color-orange { @apply text-highlight-orange; }
  .text-color-amber { @apply text-highlight-amber; }
  .text-color-yellow { @apply text-highlight-yellow; }
  .text-color-lime { @apply text-highlight-lime; }
  .text-color-green { @apply text-highlight-green; }
  .text-color-teal { @apply text-highlight-teal; }
  .text-color-cyan { @apply text-highlight-cyan; }
  .text-color-blue { @apply text-highlight-blue; }
  .text-color-indigo { @apply text-highlight-indigo; }
  .text-color-purple { @apply text-highlight-purple; }
  .text-color-pink { @apply text-highlight-pink; }

  /* Scrollbar styling - adapts to theme via CSS variables */
  .custom-scrollbar::-webkit-scrollbar {
    @apply w-2;
  }
  
  .custom-scrollbar::-webkit-scrollbar-track {
    background-color: var(--scripture-bg);
  }
  
  .custom-scrollbar::-webkit-scrollbar-thumb {
    background-color: var(--scripture-muted);
    border-radius: 9999px;
  }
  
  .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background-color: var(--scripture-muted);
    opacity: 1;
  }

  /* Backdrop overlay - uses theme-aware opacity and blurs content behind */
  .backdrop-overlay {
    background-color: rgb(0, 0, 0);
    opacity: var(--scripture-backdrop-opacity);
    backdrop-filter: blur(24px);
    -webkit-backdrop-filter: blur(24px);
  }
}

@layer utilities {
  /* Touch-friendly tap targets */
  .touch-target {
    @apply min-h-[44px] min-w-[44px];
  }

  /* Search overlay animation that preserves translateX(-50%) for centering */
  @keyframes searchScaleIn {
    0% {
      opacity: 0;
      transform: translateX(-50%) scale(0.95);
    }
    100% {
      opacity: 1;
      transform: translateX(-50%) scale(1);
    }
  }

  /* Scale-in animation for flexbox-centered modals */
  @keyframes scaleIn {
    0% {
      opacity: 0;
      transform: scale(0.95);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }

  /* Scale-in animation for absolutely positioned dropdowns (no transform) */
  @keyframes scaleInDropdown {
    0% {
      opacity: 0;
      transform: scale(0.95);
    }
    100% {
      opacity: 1;
      transform: scale(1);
    }
  }

  .animate-scale-in {
    animation: scaleIn 0.2s ease-out;
  }

  .animate-scale-in-dropdown {
    animation: scaleInDropdown 0.2s ease-out;
  }

  /* Error display fade-in animation */
  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-fade-in {
    animation: fadeIn 0.2s ease-out;
  }

  /* Annotation remove button - appears on hover */
  .annotation-group {
    position: relative;
    display: inline-block;
  }

  .annotation-group:hover .annotation-remove {
    display: flex !important;
  }

  .annotation-remove {
    position: absolute;
    top: -6px;
    right: -6px;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    background-color: var(--scripture-error);
    color: white;
    font-size: 12px;
    line-height: 1;
    display: none;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    z-index: 20;
    border: 1px solid var(--scripture-surface);
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
    padding: 0;
    margin: 0;
  }

  .annotation-remove:hover {
    opacity: 0.9;
    transform: scale(1.1);
    transition: transform 0.15s ease-out;
  }

  /* Details/summary chevron rotation for collapsible sections */
  details[open] > summary .details-open\:rotate-90 {
    transform: rotate(90deg);
  }
}
